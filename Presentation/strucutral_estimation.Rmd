---
title: "Structural Estimation of Life Cycle Models "
subtitle: "with Welth in the Utility Function"
author: "Alan E. Lujan Solis"
institute: "Ohio State University <br> Econ-ARK"
date: "`r Sys.Date()`"
output:
  xaringan::moon_reader:
    css: [default, metropolis, metropolis-fonts]
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

# Motivation and Research Quesitions

## Motivation

- HANK
- Wealth accumulation
- Lifecycle Models
  
## Research Questions

- How do we better fit the distribution of wealth at the top?
- How much does wealth in the utility function matter?
- What do we gain from Life Cycle models?

$$
\newcommand{\DiscFac}{\beta}
\newcommand{\cFunc}{\mathrm{c}}
\newcommand{\uFunc}{\mathrm{u}}
\newcommand{\vFunc}{\mathrm{v}}
\newcommand{\Alive}{\mathcal{L}}
\newcommand{\h}{h}
\newcommand{\cLvl}{\mathbf{c}}
\newcommand{\mLvl}{\mathbf{m}}
\newcommand{\pLvl}{\mathbf{p}}
\newcommand{\Ex}{\mathbb{E}}
\newcommand{\CRRA}{\rho}
\newcommand{\PermGroFac}{\pmb{\Phi}}
\newcommand{\Rfree}{\mathsf{R}}
\newcommand{\PermShk}{\mathbf{\Psi}}
\newcommand{\TranShk}{\pmb{\xi}}
\newcommand{\aNrm}{a}
\newcommand{\cNrm}{c}
\newcommand{\RNrm}{\mathcal{R}}
\newcommand{\TranShkEmp}{\pmb{\theta}}
\newcommand{\mNrm}{m}
\newcommand{\pZero}{\wp}
\newcommand{\aFunc}{\mathrm{a}}
\newcommand{\kapShare}{\alpha}
\newcommand{\wealth}{o}
\newcommand{\kap}{k}
\newcommand{\wealthShare}{\delta}
\newcommand{\wFunc}{\mathrm{w}}
\newcommand{\aRat}{a}
\newcommand{\mRat}{m}
\newcommand{\aMat}{[\mathrm{a}]}
\newcommand{\mMat}{[\mathrm{m}]}
\newcommand{\weight}{\omega}
$$

---

# The baseline LCIM model

## Life Cycle Incomplete Markets Model

The agent maximizes PDV of utility from consumption over the life cycle with a terminal period of $T$:

$$\begin{equation}
\label{eq:lifecyclemax}
\vFunc_{t}(\pLvl_{t},\mLvl_{t})  =    \max_{\{\cFunc\}_{t}^{T}} ~ \uFunc(\cLvl_{t})+\Ex_{t}\left[\sum_{n=1}^{T-t} {\beth}^{n} \Alive_{t}^{t+n}\hat{\DiscFac}_{t}^{t+n} \uFunc(\cLvl_{t+n}) \right]
\end{equation}$$

where $\pLvl_{t}$ is the permanent income level, $\mLvl_{t}$ is total market resources, $\cLvl_{t}$ is consumption, and

$$\begin{equation}
\begin{align}
    \beth & :  \text{time-invariant pure discount factor}
    \\ \Alive _{t}^{t+n} & :  \text{probability to }\Alive\text{ive until age t+n given alive at age t}
    \\ \hat{\DiscFac}_{t}^{t+n} & :  \text{age-varying discount factor between ages t and t+n.}
\end{align}
\end{equation}$$

---

# Recursive Bellman Equation

$$\begin{equation}
\begin{align}
    {\vFunc}_{t}({m}_{t}) & = \max_{\cNrm_{t}} ~ \uFunc(\cNrm_{t})+\beth\Alive_{t+1}\hat{\DiscFac}_{t+1}
    \Ex_{t}[(\PermShk_{t+1}\PermGroFac_{t+1})^{1-\CRRA}{\vFunc}_{t+1}({m}_{t+1})]
    \\ & \text{s.t.} & 
    \\ \aNrm_{t} & = {m}_{t}-\cNrm_{t} 
    \\ {m}_{t+1} & = \aNrm_{t}\underbrace{\left(\frac{\Rfree}{\PermShk_{t+1}\PermGroFac_{t+1}}\right)}_{\equiv \RNrm_{t+1}}
    + ~\TranShkEmp_{t+1}
\end{align}
\end{equation}$$

where $\cNrm$, $\aNrm$, and $\mNrm$ are consumption, assets, and market resources normalized by permanent income, respectively, $\vFunc$ and $\uFunc$ are now the normalized value and utility functions,  and

$$\begin{equation}
\begin{align}
  \PermShk_{t+1} & :  \text{mean-one shock to permanent income}
    \\ \PermGroFac_{t+1} & :  \text{permanent income growth factor}
    \\ \TranShkEmp_{t+1} & :  \text{transitory shock to permanent income}
    \\ \RNrm_{t+1} & :  \text{permanent income growth normalized return factor}
\end{align}
\end{equation}$$

with all other variables are defined as above. The transitory and permanent shocks to income are defined as:

$$\begin{equation}
\begin{align}
\TranShkEmp_{s}  = &
    \begin{cases}
        0\phantom{/\pZero} & \text{with probability $\pZero>0$}
        \\ \xi_{s}/\pZero & \text{with probability $(1-\pZero)$, where
            $\log \xi_{s}\thicksim \mathcal{N}(-\sigma_{[\xi, t]}^{2}/2,\sigma_{[\xi, t]}^{2})$}
    \end{cases}
    \\ \phantom{/\pZero} \\ & \text{and }  \log \PermShk_{s}   \thicksim \mathcal{N}(-\sigma_{[\PermShk, t]}^{2}/2,\sigma_{[\PermShk, t]}^{2}).
  \end{align}
\end{equation}$$

---

# The WUFIM model

## Wealth in the Utility Function Incomplete Markets model 

$$\begin{equation}
\begin{align}
    {\vFunc}_{t}({m}_{t}) & = \max_{\cNrm_{t}} ~ \uFunc(\cNrm_{t}, \aNrm_{t})+\beth\Alive_{t+1}\hat{\DiscFac}_{t+1}
    \Ex_{t}[(\PermShk_{t+1}\PermGroFac_{t+1})^{1-\CRRA}{\vFunc}_{t+1}({m}_{t+1})]
    \\ & \text{s.t.} & 
    \\ \aNrm_{t} & = {m}_{t}-\cNrm_{t} 
    \\ {m}_{t+1} & = \aNrm_{t}\RNrm_{t+1}+ ~\TranShkEmp_{t+1}
\end{align}
\end{equation}$$

---

# Functional Forms

\textbf{Separable Utility} 

$$\begin{equation}
\uFunc(\cNrm_{t}, \aNrm_{t}) = \frac{\cNrm_{t}^{1-\CRRA}}{1-\CRRA}
    + \kapShare_{t} \frac{(\aFunc_{t} - \underline\aNrm)^{1-\wealthShare}}{1-\wealthShare}
\end{equation}$$

Non-separable Utility


$$\begin{equation}
\uFunc(\cNrm_{t}, \aNrm_{t}) = \frac{(\cNrm_{t}^{1-\wealthShare} (\aNrm_{t} - \underline\aNrm)^\wealthShare)^{1-\CRRA}}{(1-\CRRA)}
\end{equation}$$

---

# Estimation

## Objective Function

$$\begin{equation}
\label{eq:naivePowell}
g(\Theta) =  \sum_{\tau=1}^{7} \weight_{\tau} |\varsigma^{\tau} -\mathbf{s}^{\tau}(\Theta)|
\end{equation}$$

## Baseline Results

$$\begin{table}
\centering
\caption{LCIM Estimation Results}
\label{LCIMestimation}
\begin{tabular}{p{\dimexpr 0.500\linewidth-2\tabcolsep}p{\dimexpr 0.500\linewidth-2\tabcolsep}}
\toprule
$\beth$ & $\CRRA$ \\
\hline
0.878 & 3.516 \\
(0.0018) & (0.0266) \\
\bottomrule
\end{tabular}
\end{table}$$

## Baseline Contour 

$$\begin{figure}[!htbp]
\centering
\includegraphics[width=0.7\linewidth]{files/IndShockSMMcontour-f950f8faf8926e47605d36d01964a2f6.pdf}
\caption{Contour plot of the objective function for the structural estimation of the Life Cycle Incomplete Markets model. The red dot represents the estimated parameters.}
\label{fig:IndShockSMMcontour}
\end{figure}$$

---

# WUFIM Results

$$\begin{table}
\centering
\caption{WUFIM Estimation Results}
\label{WUFIMestimation}
\begin{tabular}{p{\dimexpr 0.333\linewidth-2\tabcolsep}p{\dimexpr 0.333\linewidth-2\tabcolsep}p{\dimexpr 0.333\linewidth-2\tabcolsep}}
\toprule
Model & $\beth$ & $\CRRA$ \\
\hline
LCIM w/ Portfolio Choice & 0.866 & 3.756 \\
 & (0.0011) & (0.0313) \\
Separable WUFIM & 0.876 & 3.506 \\
 & (0.0012) & (0.0254) \\
Separable WUFIM w/ Portfolio & 0.864 & 3.806 \\
 & (0.0012) & (0.0263) \\
Non-Separable WUFIM & 0.601 & 5.032 \\
 & (0.0026) & (0.0634) \\
\bottomrule
\end{tabular}
\end{table}$$

---

# WUFIM Contour

$$\begin{figure}[!htbp]
\centering
\includegraphics[width=0.7\linewidth]{files/AllSMMcontour-61083533183861c53042688308f7803e.pdf}
\caption{Contour plot of the objective function for the structural estimation of the Life Cycle Incomplete Markets model. The red dot represents the estimated parameters.}
\label{fig:AllSMMcontour}
\end{figure}$$

---

# Sensitivity Analysis

$$\begin{figure}[!htbp]
\centering
\includegraphics[width=0.7\linewidth]{files/IndShockSensitivity-9046783d8c17a2fc3e39f5fb5ebcf6c7.pdf}
\caption{Sensitivity analysis of the structural estimation of the Life Cycle Incomplete Markets model. The red dot represents the estimated parameters.}
\label{fig:IndShockSensitivity}
\end{figure}$$

---

$$\begin{figure}[!htbp]
\centering
\includegraphics[width=0.7\linewidth]{files/AllSensitivity-0f14236654de527c752f26a13f644a4c.pdf}
\caption{Sensitivity analysis of the structural estimation of the Life Cycle Incomplete Markets model. The red dot represents the estimated parameters.}
\label{fig:AllSensitivity}
\end{figure}$$

---

# Conclusion

